<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DocETL — VLDB Talk</title>

    <!-- Inter font -->
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
    <!-- Handwriting font for playful callouts -->
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@600&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Reveal.js (CDN) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5/dist/reveal.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5/dist/theme/white.css" id="theme" />

    <!-- Custom theme overrides -->
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <!-- Title -->
        <section data-transition="fade">
          <div class="title-slide">
            <img class="title-logo" src="images/docetl-logo.svg" alt="DocETL" />
            <h1>Agentic Query Rewriting and Evaluation for Complex Document Processing</h1>
            <p class="authors" style="position: relative;"><span class="name-highlight-trigger fragment" data-fragment-index="1" aria-hidden="true"></span><strong class="speaker-name" id="speaker-name">Shreya Shankar</strong><sup>1</sup>, Tristan Chambers<sup>2</sup>, Tarak Shah<sup>2</sup>,
              Aditya G. Parameswaran<sup>1</sup>, Eugene Wu<sup>3</sup>
              <!-- Callout positioned relative to authors paragraph -->
              <span class="inline-callout fragment small" data-fragment-index="1">
                <svg class="inline-arrow" width="180" height="50" viewBox="0 0 180 50" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                  <path d="M2,45 Q40,20 80,15 T160,20" />
                  <path d="M160,20 l-7,-4 l4,8" />
                </svg>
                <span class="bubble">on the faculty job market!</span>
              </span>
            </p>
            <p class="affiliations-text small">
              <span><sup>1</sup>UC Berkeley EECS</span> •
              <span><sup>2</sup>BIDS Police Records Access Project</span> •
              <span><sup>3</sup>Columbia University</span>
            </p>
            <div class="affiliations">
              <div class="logos">
                <img src="images/epic-logo.png" alt="EPIC Lab" />
                <img src="images/daplab_logo_horiz.png" alt="DAPLab" />
              </div>
              <div class="title-meta small">
                <span><a href="https://docetl.org" target="_blank" rel="noopener">docetl.org</a></span>
                <span>•</span>
                <span>⭐ 2.8k GitHub stars</span>
              </div>
            </div>
          </div>
        </section>

       



        <!-- The New Era -->
        <section>
          <h2>A New Era for Unstructured Data</h2>
          
          <p class="fragment" data-fragment-index="1" style="font-size: 32px; margin: 0.8rem 0 1.2rem;">
            Modern AI enables powerful data systems
          </p>
          
          <!-- Compact zig-zag layout with light yellow cards -->
          <div style="margin-top: 0.5rem;">
            <!-- Healthcare - left aligned -->
            <div class="fragment" data-fragment-index="2" style="display: flex; align-items: center; margin-bottom: 0.3rem;">
              <div style="display: flex; align-items: center; background: #FFF3E0; padding: 0.5rem 1rem; border-radius: 4px;">
                <div style="text-align: center; min-width: 100px;">
                  <i class="fas fa-stethoscope" style="font-size: 32px; color: var(--berkeley-blue);"></i>
                  <p style="font-size: 28px; margin: 0; color: var(--berkeley-blue);">Healthcare</p>
                </div>
                <div style="margin-left: 1.2rem;">
                  <p style="font-size: 30px; margin: 0; font-style: italic;">
                    "What side effects do patients report for Ozempic?"
                  </p>
                </div>
              </div>
            </div>
            
            <!-- Legal - right aligned -->
            <div class="fragment" data-fragment-index="3" style="display: flex; align-items: center; margin-bottom: 0.3rem; justify-content: flex-end;">
              <div style="display: flex; align-items: center; background: #FFF3E0; padding: 0.5rem 1rem; border-radius: 4px;">
                <div style="margin-right: 1.2rem;">
                  <p style="font-size: 30px; margin: 0; font-style: italic;">
                    "Which contracts have unfavorable arbitration clauses?"
                  </p>
                </div>
                <div style="text-align: center; min-width: 100px;">
                  <i class="fas fa-gavel" style="font-size: 32px; color: var(--berkeley-blue);"></i>
                  <p style="font-size: 28px; margin: 0; color: var(--berkeley-blue);">Legal</p>
                </div>
              </div>
            </div>
            
            <!-- Commerce - left aligned -->
            <div class="fragment" data-fragment-index="4" style="display: flex; align-items: center; margin-bottom: 0.3rem;">
              <div style="display: flex; align-items: center; background: #FFF3E0; padding: 0.5rem 1rem; border-radius: 4px;">
                <div style="text-align: center; min-width: 100px;">
                  <i class="fas fa-shopping-cart" style="font-size: 32px; color: var(--berkeley-blue);"></i>
                  <p style="font-size: 28px; margin: 0; color: var(--berkeley-blue);">Commerce</p>
                </div>
                <div style="margin-left: 1.2rem;">
                  <p style="font-size: 30px; margin: 0; font-style: italic;">
                    "What are customers complaining about in reviews?"
                  </p>
                </div>
              </div>
            </div>
            
            <!-- Science - right aligned -->
            <div class="fragment" data-fragment-index="5" style="display: flex; align-items: center; margin-bottom: 1rem; justify-content: flex-end;">
              <div style="display: flex; align-items: center; background: #FFF3E0; padding: 0.5rem 1rem; border-radius: 4px;">
                <div style="margin-right: 1.2rem;">
                  <p style="font-size: 30px; margin: 0; font-style: italic;">
                    "Which papers contradict our hypothesis?"
                  </p>
                </div>
                <div style="text-align: center; min-width: 100px;">
                  <i class="fas fa-flask" style="font-size: 32px; color: var(--berkeley-blue);"></i>
                  <p style="font-size: 28px; margin: 0; color: var(--berkeley-blue);">Science</p>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Final question - no card, just bold text -->
          <div class="fragment" data-fragment-index="6" style="text-align: center; margin-top: 1.5rem;">
            <p style="font-size: 36px; margin: 0; color: var(--berkeley-blue); font-weight: 700;">
              How do we process unstructured data <span style="text-decoration: underline;">at scale</span>, in <span style="text-decoration: underline;">complex</span> ways?
            </p>
          </div>
        </section>

        <!-- Example: Police Misconduct Analysis -->
        <section>
          <h2>Example: Extracting Police Misconduct</h2>
          <p style="font-size: 24px; margin-top: -0.5rem;">
            <a href="https://bids.berkeley.edu/california-police-records-access-project" target="_blank" style="color: var(--founders-rock); text-decoration: underline;">California Police Records Access Project</a>
          </p>
          
          <div style="display: flex; gap: 4rem; align-items: flex-start; margin-top: -1rem;">
            <!-- Left: Task and stacked document images (centered; no caption overlay) -->
            <div style="flex: 0.4;">
              <p style="font-size: 32px; margin-bottom: 0.2rem;"><strong>Task:</strong> Build table of officer misconduct (e.g., excessive use of force, evidence tampering)</p>
              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -1rem;">
                <div style="position: relative; width: 230px; height: 240px;">
                  <img src="images/record.png" alt="Police report" style="position: absolute; top: 0; left: 0; width: 210px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transform: rotate(-2deg);">
                  <img src="images/record.png" alt="Police report" style="position: absolute; top: 12px; left: 12px; width: 210px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transform: rotate(1deg); opacity: 0.9;">
                  <img src="images/record.png" alt="Police report" style="position: absolute; top: 24px; left: 24px; width: 210px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transform: rotate(-0.5deg); opacity: 0.85;">
                </div>
              </div>
            </div>
            
            <!-- Right: Static Pipeline with simple fragments -->
            <div style="flex: 0.6; position: relative; display: flex; flex-direction: column;">
              <!-- Map -->
              <div class="fragment" data-fragment-index="1" style="background: #FFF3E0; padding: 1rem 1.5rem; border-radius: 8px;">
                <p style="font-size: 32px; margin: 0;"><strong>Map:</strong> Extract (officer, misconduct)</p>
              </div>
              <!-- Map problems under Map -->
              <div class="fragment" data-fragment-index="2" style="background: white; border: 2px solid #dc3545; border-radius: 8px; padding: 0.8rem; margin: 0.5rem 0 0.8rem 2rem;">
                <p style="font-size: 28px; color: #dc3545; font-weight: 700; margin: 0;">→ Low recall in long docs & complex misconduct types</p>
              </div>
              <!-- Reduce -->
              <div class="fragment" data-fragment-index="1" style="background: #FFF3E0; padding: 1rem 1.5rem; border-radius: 8px;">
                <p style="font-size: 32px; margin: 0;"><strong>Reduce:</strong> Group by officer & summarize misconduct</p>
              </div>
              <!-- Reduce problems under Reduce -->
              <div class="fragment" data-fragment-index="4" style="background: white; border: 2px solid #dc3545; border-radius: 8px; padding: 0.8rem; margin: 0.5rem 0 0 2rem;">
                <p style="font-size: 28px; line-height: 1.2; margin: 0;">
                  • Officer Smith: [excessive force]<br>
                  • Officer J. Smith: [abuse of power]
                </p>
                <p style="color: #dc3545; font-size: 28px; margin: 0.3rem 0 0; font-weight: bold;">→ Same person, different groups!</p>
              </div>
            </div>
          </div>
          
          <!-- Bottom message -->
          <div class="fragment" data-fragment-index="5" style="text-align: center; margin-top: 1.4rem;">
            <p style="font-size: 34px; color: var(--berkeley-blue); font-weight: 600; margin: 0;">
              LLM-powered operators aren't always accurate,<br>
              so we need to rewrite the pipeline into smaller steps
            </p>
          </div>
        </section>

        <!-- Decomposing Map → Reduce into Smaller Operations -->
        <section>
          <h2>Rewriting Our Pipeline</h2>

          <div style="display: flex; flex-direction: column; gap: 1.2rem; margin-top: 0.5rem; position: relative;">
            <!-- Row 1: Original pipeline -->
            <div class="fragment" data-fragment-index="1" style="display: flex; align-items: stretch; gap: 0.6rem;">
              <div style="background: #F5F5F5; border: 1px solid #DDD; border-radius: 8px; padding: 0.8rem 1rem; min-width: 240px; position: relative;">
                <div style="font-size: 28px; font-weight: 700; color: var(--berkeley-blue);">Input</div>
                <div style="font-size: 24px; line-height: 1.2;">200+ pg PDF (per county)</div>
              </div>
              <div style="font-size: 32px; line-height: 1; align-self: center;">→</div>
              <div style="background: #FFF3E0; border: none; border-radius: 8px; padding: 0.8rem 1rem; min-width: 280px; position: relative;">
                <div style="font-size: 28px; font-weight: 700; color: var(--medalist);">Map</div>
                <div style="font-size: 24px; line-height: 1.2;">extract all (officer, misconduct) instances</div>
                <div class="fragment fade-in-then-out" data-fragment-index="2" style="position: absolute; inset: -6px; border-radius: 10px; box-shadow: 0 0 26px 8px rgba(253,181,21,0.55); pointer-events: none;"></div>
                <i class="fragment fade-in-then-out fas fa-hand-pointer" data-fragment-index="2" style="position: absolute; top: -18px; right: 10px; font-size: 28px; color: var(--berkeley-gold); transform: rotate(10deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));"></i>
                <!-- Connector to row 2 appears with row 2 -->
                
              </div>
              <div style="font-size: 32px; line-height: 1; align-self: center;">→</div>
              <div style="background: #E8F0FE; border: none; border-radius: 8px; padding: 0.8rem 1rem; min-width: 280px; position: relative;">
                <div style="font-size: 28px; font-weight: 700; color: var(--berkeley-blue);">Reduce</div>
                <div style="font-size: 24px; line-height: 1.2;">group by officer, summarize misconduct</div>
                <div class="fragment fade-in-then-out" data-fragment-index="8" style="position: absolute; inset: -6px; border-radius: 10px; box-shadow: 0 0 26px 8px rgba(59,126,161,0.45); pointer-events: none;"></div>
                <i class="fragment fade-in-then-out fas fa-hand-pointer" data-fragment-index="8" style="position: absolute; top: -18px; right: 10px; font-size: 28px; color: var(--founders-rock); transform: rotate(10deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));"></i>
              </div>
            </div>

            <!-- Separator between user pipeline (top) and DocETL rewrites (bottom) -->
            <div class="fragment" data-fragment-index="3" aria-hidden="true" style="margin: 0.4rem 0 0.2rem; position: relative;">
              <div style="border-top: 2px dashed #DDD;"></div>
              <div style="position: absolute; top: -14px; left: 50%; transform: translateX(-50%); background: var(--off-white); padding: 0 10px; color: var(--text-light); font-size: 24px;">
                Rewrites
              </div>
            </div>

            <!-- Row 2: Case-level segmentation path -->
            <div class="fragment" data-fragment-index="3" style="display: flex; align-items: stretch; justify-content: center; gap: 0.6rem;">
              <div style="background: #FFF3E0; border: none; border-radius: 8px; padding: 0.8rem 1rem; min-width: 260px; position: relative;">
                <div style="font-size: 28px; font-weight: 700; color: var(--medalist);">Split by Case</div>
                <div style="font-size: 24px; line-height: 1.2;">extract case # + metadata</div>
                <div class="fragment fade-in-then-out" data-fragment-index="4" style="position: absolute; inset: -6px; border-radius: 10px; box-shadow: 0 0 26px 8px rgba(253,181,21,0.55); pointer-events: none;"></div>
                <i class="fragment fade-in-then-out fas fa-hand-pointer" data-fragment-index="4" style="position: absolute; top: -18px; right: 10px; font-size: 28px; color: var(--berkeley-gold); transform: rotate(10deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));"></i>
              </div>
              <div style="font-size: 32px; line-height: 1; align-self: center;">→</div>
              <div style="background: #FFF3E0; border: none; border-radius: 8px; padding: 0.8rem 1rem; min-width: 260px; position: relative;">
                <div style="font-size: 28px; font-weight: 700; color: var(--medalist);">Map</div>
                <div style="font-size: 24px; line-height: 1.2;">per case: extract all (officer, misconduct)</div>
                <div class="fragment fade-in-then-out" data-fragment-index="6" style="position: absolute; inset: -6px; border-radius: 10px; box-shadow: 0 0 26px 8px rgba(253,181,21,0.55); pointer-events: none;"></div>
                <i class="fragment fade-in-then-out fas fa-hand-pointer" data-fragment-index="6" style="position: absolute; top: -18px; right: 10px; font-size: 28px; color: var(--berkeley-gold); transform: rotate(10deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));"></i>
              </div>
              <div class="fragment" data-fragment-index="4" style="display: flex; align-items: center; gap: 0.35rem; color: #dc3545; font-size: 26px;">
                <i class="fas fa-times-circle"></i>
                <span style="font-weight: 700;">still poor recall!</span>
              </div>
            </div>

            <!-- Row 3: Token-level chunking + context, plus specialized maps -->
            <div class="fragment" data-fragment-index="5" style="display: flex; align-items: stretch; gap: 0.6rem;">
              <div style="background: #FFF3E0; border: none; border-radius: 8px; padding: 0.8rem 1rem; position: relative;">
                <div style="font-size: 28px; font-weight: 700; color: var(--medalist);">Split by Token</div>
                <div style="font-size: 24px; line-height: 1.2;">+ case metadata</div>
                <div class="fragment fade-in-then-out" data-fragment-index="5" style="position: absolute; inset: -6px; border-radius: 10px; box-shadow: 0 0 26px 8px rgba(253,181,21,0.55); pointer-events: none;"></div>
                <i class="fragment fade-in-then-out fas fa-hand-pointer" data-fragment-index="5" style="position: absolute; top: -18px; right: 10px; font-size: 28px; color: var(--berkeley-gold); transform: rotate(10deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25));"></i>
              </div>
              <div class="fragment" data-fragment-index="7" style="font-size: 32px; line-height: 1; align-self: center;">→</div>
              <div class="fragment" data-fragment-index="7" style="background: #FFF3E0; border: none; border-radius: 8px; padding: 0.6rem 0.8rem; min-width: 220px;">
                <div style="font-size: 26px; font-weight: 700; color: var(--medalist);">Map: Force</div>
                <div style="font-size: 24px; color: var(--text-light);">unreasonable force</div>
              </div>
              <div class="fragment" data-fragment-index="7" style="font-size: 32px; line-height: 1; align-self: center;">→</div>
              <div class="fragment" data-fragment-index="7" style="background: #FFF3E0; border: none; border-radius: 8px; padding: 0.6rem 0.8rem; min-width: 220px;">
                <div style="font-size: 26px; font-weight: 700; color: var(--medalist);">Map: Slurs</div>
                <div style="font-size: 24px; color: var(--text-light);">racial statements</div>
              </div>
              <div class="fragment" data-fragment-index="7" style="font-size: 32px; line-height: 1; align-self: center;">→</div>
              <div class="fragment" data-fragment-index="7" style="background: #FFF3E0; border: none; border-radius: 8px; padding: 0.6rem 0.8rem; min-width: 240px;">
                <div style="font-size: 26px; font-weight: 700; color: var(--medalist);">Map: Dishonesty</div>
                <div style="font-size: 24px; color: var(--text-light);">e.g., tampering</div>
              </div>
              <div class="fragment" data-fragment-index="7" style="display: flex; align-items: center; color: var(--success-green); font-size: 28px; margin-left: 0.2rem;">
                <i class="fas fa-check-circle"></i>
              </div>
            </div>

            <!-- Row 5: Entity Resolution → Reduce (combined) -->
            <div class="fragment" data-fragment-index="9" style="display: flex; align-items: stretch; justify-content: flex-end; gap: 0.6rem;">
              <div style="background: #E8F0FE; border: none; border-radius: 8px; padding: 0.8rem 1rem; display: flex; flex-direction: column; justify-content: center;">
                <div style="font-size: 28px; font-weight: 700; color: var(--berkeley-blue);">Entity Resolution</div>
                <div style="font-size: 24px; line-height: 1.2;">normalize officer names</div>
              </div>
              <div style="font-size: 32px; line-height: 1; align-self: center;">→</div>
              <div style="background: #E8F0FE; border: none; border-radius: 8px; padding: 0.8rem 1rem; display: flex; flex-direction: column; justify-content: center;">
                <div style="font-size: 28px; font-weight: 700; color: var(--berkeley-blue);">Reduce</div>
                <div style="font-size: 24px; line-height: 1.2;">group by officer, summarize misconduct</div>
              </div>
            </div>
            <div class="fragment" data-fragment-index="9" style="display: flex; justify-content: flex-end; margin-top: 0.1rem;">
              <div style="font-size: 34px; color: var(--text-light); line-height: 1;">…</div>
            </div>
          </div>

          <div class="fragment" data-fragment-index="10" style="text-align: center; margin-top: 0.8rem;">
            <p style="font-size: 34px; color: var(--berkeley-blue); font-weight: 600; margin: 0;">
              How can we automate and scale up such rewrites?
            </p>
          </div>

          <aside class="notes">
            Start with the original pipeline: Map over the entire county PDF and Reduce by officer. Highlight why Map underperforms. Next, decompose the data unit: Split by Case (bespoke case# + metadata extraction). Focus on Split by Case, then show Split by Tokens with case summary/metadata to make chunks understandable. Focus on the per-case Map, then decompose Map into targeted detectors: force, slurs, dishonesty. Finally, focus on Reduce and introduce Entity Resolution → Group by Officer → Summarize Evidence, with decomposition for long sources. The point: smaller, verifiable steps improve accuracy and control, motivating a declarative DocETL.
          </aside>
        </section>

        <!-- DocETL Intro (Hero) -->
        <section>
          <div style="position: relative;">
            <!-- Top-right GitHub badge -->
            <div style="position: absolute; right: 0; top: -0.4rem; background: #F5F7FA; color: var(--text-dark); border-radius: 10px; padding: 0.3rem 0.6rem; font-size: 28px; white-space: nowrap;">
              2.8k GitHub stars&nbsp;&nbsp;
              <a href="https://github.com/ucbepic/docetl" target="_blank" style="color: var(--founders-rock); text-decoration: underline;">github.com/ucbepic/docetl</a>
            </div>

            <h2>DocETL</h2>
            <p style="font-size: 34px; margin: -0.2rem 0 0.8rem; color: var(--text-dark); font-weight: 700;">Declarative system for LLM‑powered unstructured text</p>

            <!-- Content with star image on the right -->
            <div style="display: flex; align-items: flex-start; gap: 1.6rem;">
              <div style="flex: 1;">
                <div style="margin-top: 0.1rem;">
                  <p class="fragment" data-fragment-index="1" style="font-size: 30px; line-height: 1.3; color: var(--text-dark); margin: 0 0 1.5rem;">Open‑source; traction in law, policy, public defense</p>
                  <p class="fragment" data-fragment-index="2" style="font-size: 30px; line-height: 1.3; color: var(--medalist); font-weight: 700; margin: 0.2rem 0 1.4rem;">Key Contributions</p>
                  <ul style="list-style: none; padding: 0; margin: 0;">
                    <li class="fragment" data-fragment-index="3" style="font-size: 30px; line-height: 1.3; color: var(--text-dark); margin: 0 0 1.5rem; position: relative; padding-left: 2rem;">
                      <span style="position: absolute; left: 0; top: 0.2rem; color: var(--medalist); font-size: 16px;">▶</span>
                      <span style="text-decoration: underline;">Rewrite directives</span>: LLM‑interpreted guidelines that synthesize operators
                    </li>
                    <li class="fragment" data-fragment-index="4" style="font-size: 30px; line-height: 1.3; color: var(--text-dark); margin: 0; position: relative; padding-left: 2rem;">
                      <span style="position: absolute; left: 0; top: 0.2rem; color: var(--medalist); font-size: 16px;">▶</span>
                      Search algorithm to navigate the rewrite space for higher‑accuracy plans
                    </li>
                  </ul>
                </div>
              </div>
              <div style="flex: 0.48; display: flex; justify-content: flex-end;">
                <img src="images/star-history-2025828.png" alt="DocETL star history" style="width: 100%; max-width: 580px; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); background: white;">
              </div>
            </div>

            <!-- Divider above logos -->
            <div style="border-top: 1px solid #E6E8EB; margin: 3rem 0 1.5rem;"></div>
            <!-- Logos bottom strip: single centered line, full color -->
            <div style="display: flex; flex-wrap: nowrap; gap: 1.2rem; align-items: center; justify-content: center;">
              <img src="images/users/AT&T_logo_2016.png" alt="AT&T" style="height: 34px; object-fit: contain;">
              <img src="images/users/3gpp.png" alt="3GPP" style="height: 34px; object-fit: contain;">
              <img src="images/users/usepa.png" alt="US EPA" style="height: 34px; object-fit: contain;">
              <img src="images/users/SF-Public-Defender_LOGO_blue-1.png" alt="SF Public Defender" style="height: 34px; object-fit: contain;">
              <img src="images/users/barassociation.png" alt="Bar Association" style="height: 34px; object-fit: contain;">
              <img src="images/users/SCIS-logo.png" alt="SCIS" style="height: 34px; object-fit: contain;">
              <img src="images/users/inta_logo.png" alt="INTA" style="height: 34px; object-fit: contain;">
              <img src="images/users/mti-logo.png" alt="MTI" style="height: 34px; object-fit: contain;">
              <img src="images/users/Zenoti-Word-Mark-Standard-Color-1920-1024x293.png" alt="Zenoti" style="height: 34px; object-fit: contain;">
              <img src="images/users/ankihub.jpeg" alt="AnkiHub" style="height: 34px; object-fit: contain; border-radius: 4px;">
            </div>
          </div>

          <aside class="notes">
            I’ll talk about two ideas today. First: our novel “rewrite directives.” They’re inspired by database rewrite rules, but they’re not hard-coded rules— they’re structured guidelines interpreted by LLM agents. That means the optimizer can synthesize new algorithmic implementations on the fly for the task.

            Second: how we search this very open-ended space of rewrites to find a more accurate execution plan.

            We open-sourced DocETL last fall and have been gaining modest traction, especially in domains dominated by unstructured text—law, policy, public defense, and scribing. Because these domains work primarily with unstructured data, the database community has historically had less impact there. I’m excited about this vision and I hope to convince you this is an exciting new area to work in.
          </aside>
        </section>

        <section>
          <h2>DSL &amp; Operators</h2>
          <div class="operators-overview" style="max-width: 100%;">
            <div class="operators-grid-full">
        
              <!-- LLM-Powered -->
              <div class="operator-group">
                <h3 style="font-size: 30px; color: var(--berkeley-blue); margin-bottom: 0.8rem;">LLM-Powered</h3>
                <div style="display: flex; align-items: flex-start; gap: 1rem;">
                  <div class="operator-items">
                    <span class="op-badge">map</span>
                    <span class="op-badge">reduce</span>
                    <span class="op-badge">filter</span>
                    <span class="op-badge">equijoin</span>
                    <span class="op-badge">resolve</span>
                    <span class="op-badge">parallel_map</span>
                    <span class="op-badge new fragment" data-fragment-index="1">extract</span>
                    <span class="op-badge new fragment" data-fragment-index="1">rank</span>
                    <span class="op-badge new fragment" data-fragment-index="1">topk</span>
                    <span class="op-badge new fragment" data-fragment-index="1">cluster</span>
                  </div>
                  <div class="fragment" data-fragment-index="1" style="background: rgba(255, 193, 7, 0.2); padding: 0.6rem 0.8rem; font-size: 28px; color: var(--text-dark); border-radius: 6px; max-width: 220px;">
                    Not in paper; emerged from community needs
                  </div>
                </div>
              </div>
        
              <!-- Code-Powered -->
              <div class="operator-group">
                <h3 style="font-size: 30px; color: var(--berkeley-blue); margin-bottom: 0.8rem;">Code-Powered</h3>
                <div style="display: flex; align-items: flex-start; gap: 1rem;">
                  <div class="operator-items">
                    <span class="op-badge new fragment" data-fragment-index="1">code_map</span>
                    <span class="op-badge new fragment" data-fragment-index="1">code_filter</span>
                    <span class="op-badge new fragment" data-fragment-index="1">code_reduce</span>
                  </div>
                 
                </div>
              </div>
        
              <!-- Utility -->
              <div class="operator-group" style="margin-top: 2rem;">
                <div style="display: flex; align-items: baseline; gap: 0.6rem; margin-bottom: 0.8rem;">
                  <h3 style="font-size: 30px; color: var(--berkeley-blue); margin: 0;">Utility</h3>
                  <span class="note-label">Necessary for Rewrites</span>
                </div>
                <div class="operator-items">
                  <span class="op-badge" id="split-badge">split</span>
                  <span class="op-badge" id="gather-badge">gather</span>
                  <span class="op-badge">unnest</span>
                </div>
              </div>
        
            </div>
          </div>
        </section>
        

        <!-- Split & Gather deep dive -->
        <section>
          <h2>Split &amp; Gather</h2>
          <!-- Single column layout -->
          <div>
              <!-- Row 1 header -->
              <h3 class="fragment" data-fragment-index="1" style="font-size: 34px; margin: 0 0 0.3rem 0; color: #333;">Split: Turn documents into chunks</h3>
              <!-- Row 1: 4 chunks -->
              <div class="fragment" data-fragment-index="1" style="display: flex; gap: 0.6rem;">
                <!-- Top third -->
                <div style="flex: 1; border: 1px solid #E2E6EA; border-radius: 8px; overflow: hidden; background: white; position: relative; height: 160px;">
                  <img src="images/record.png" alt="Chunk 1 slice" style="width: 100%; height: 100%; object-fit: cover; object-position: top;"/>
                  <div style="position: absolute; bottom: 6px; left: 6px; font-size: 30px; background: rgba(250,250,250,0.9); padding: 0.1rem 0.4rem; border-radius: 4px; border: 1px solid #E2E6EA; color: var(--medalist);">Chunk 1</div>
                </div>
                <!-- Middle third -->
                <div style="flex: 1; border: 1px solid #E2E6EA; border-radius: 8px; overflow: hidden; background: white; position: relative; height: 160px;">
                  <img src="images/record.png" alt="Chunk 2 slice" style="width: 100%; height: 100%; object-fit: cover; object-position: 0 33%;"/>
                  <div style="position: absolute; bottom: 6px; left: 6px; font-size: 30px; background: rgba(250,250,250,0.9); padding: 0.1rem 0.4rem; border-radius: 4px; border: 1px solid #E2E6EA; color: var(--medalist);">Chunk 2</div>
                </div>
                <!-- Third -->
                <div style="flex: 1; border: 1px solid #E2E6EA; border-radius: 8px; overflow: hidden; background: white; position: relative; height: 160px;">
                  <img src="images/record.png" alt="Chunk 3 slice" style="width: 100%; height: 100%; object-fit: cover; object-position: 0 66%;"/>
                  <div style="position: absolute; bottom: 6px; left: 6px; font-size: 30px; background: rgba(250,250,250,0.9); padding: 0.1rem 0.4rem; border-radius: 4px; border: 1px solid #E2E6EA; color: var(--medalist);">Chunk 3</div>
                </div>
                <!-- Fourth -->
                <div style="flex: 1; position: relative;">
                  <div style="border: 1px solid #E2E6EA; border-radius: 8px; overflow: hidden; background: white; position: relative; height: 160px;">
                    <img src="images/record.png" alt="Chunk 4 slice" style="width: 100%; height: 100%; object-fit: cover; object-position: bottom;"/>
                    <div style="position: absolute; bottom: 6px; left: 6px; font-size: 30px; background: rgba(250,250,250,0.9); padding: 0.1rem 0.4rem; border-radius: 4px; border: 1px solid #E2E6EA; color: var(--medalist);">Chunk 4</div>
                  </div>
                  <div class="fragment" data-fragment-index="2" style="position: absolute; inset: -6px; border-radius: 10px; box-shadow: 0 0 26px 8px rgba(253,181,21,0.55); pointer-events: none; z-index: 2;"></div>
                  <i class="fragment fas fa-hand-pointer" data-fragment-index="2" style="position: absolute; top: -18px; right: 10px; font-size: 28px; color: var(--berkeley-gold); transform: rotate(10deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.25)); z-index: 3;"></i>
                </div>
              </div>
              <!-- Gather configurations under chunks (inside right column) -->
              <div class="fragment" data-fragment-index="3" style="margin-top: 2rem;">
                <h3 style="font-size: 34px; margin: 0 0 0.3rem 0; color: #333;">Gather: augment chunks to make sense to downstream LLM operators</h3>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.8rem; align-items: start;">
                  <!-- Prefix head: chunk 1 (small) + chunk 4 -->
                  <div class="fragment" data-fragment-index="4">
                    <div style="font-size: 30px; color: var(--text-light); margin-bottom: 0.3rem;">Prefix head</div>
                  <div style="border: 1px solid #E2E6EA; border-radius: 8px; padding: 0.4rem; background: white; position: relative;">
                  <div style="border: 1px dashed #E2E6EA; border-radius: 6px; overflow: hidden; height: 54px; margin-bottom: 0.4rem; position: relative;">
                    <img src="images/record.png" alt="Head slice" style="width: 100%; height: 100%; object-fit: cover; object-position: top; opacity: 0.9;"/>
                    <div style="position: absolute; top: 6px; left: 6px; font-size: 20px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-weight: 600;">1</div>
                  </div>
                  <div style="border: 1px solid #E2E6EA; border-radius: 6px; overflow: hidden; height: 110px; position: relative;">
                    <img src="images/record.png" alt="Target chunk" style="width: 100%; height: 100%; object-fit: cover; object-position: bottom;"/>
                    <div style="position: absolute; top: 6px; left: 6px; font-size: 20px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-weight: 600;">4</div>
                  </div>
                  </div>
                  </div>

                  <!-- Prefix tail: chunk 2 (small) + chunk 4 -->
                  <div class="fragment" data-fragment-index="5">
                    <div style="font-size: 30px; color: var(--text-light); margin-bottom: 0.3rem;">Prefix tail</div>
                  <div style="border: 1px solid #E2E6EA; border-radius: 8px; padding: 0.4rem; background: white; position: relative;">
                  <div style="border: 1px dashed #E2E6EA; border-radius: 6px; overflow: hidden; height: 54px; margin-bottom: 0.4rem; position: relative;">
                    <img src="images/record.png" alt="Tail slice" style="width: 100%; height: 100%; object-fit: cover; object-position: center; opacity: 0.9;"/>
                    <div style="position: absolute; top: 6px; left: 6px; font-size: 20px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-weight: 600;">3</div>
                  </div>
                  <div style="border: 1px solid #E2E6EA; border-radius: 6px; overflow: hidden; height: 110px; position: relative;">
                    <img src="images/record.png" alt="Target chunk" style="width: 100%; height: 100%; object-fit: cover; object-position: bottom;"/>
                    <div style="position: absolute; top: 6px; left: 6px; font-size: 20px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-weight: 600;">4</div>
                  </div>
                  </div>
                  </div>

                  <!-- Prefix summary: chunks 1, 2, 3 then chunk 4 -->
                  <div class="fragment" data-fragment-index="6">
                    <div style="font-size: 30px; color: var(--text-light); margin-bottom: 0.3rem;">Prefix summary</div>
                  <div style="border: 1px solid #E2E6EA; border-radius: 8px; padding: 0.4rem; background: white; position: relative;">
                  <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.3rem; margin-bottom: 0.4rem;">
                    <div style="border: 1px dashed #E2E6EA; border-radius: 6px; overflow: hidden; height: 36px; position: relative;">
                      <img src="images/record.png" alt="Prefix part 1" style="width: 100%; height: 100%; object-fit: cover; object-position: top; opacity: 0.9;"/>
                      <div style="position: absolute; top: 3px; left: 3px; font-size: 14px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-weight: 600;">1</div>
                    </div>
                    <div style="border: 1px dashed #E2E6EA; border-radius: 6px; overflow: hidden; height: 36px; position: relative;">
                      <img src="images/record.png" alt="Prefix part 2" style="width: 100%; height: 100%; object-fit: cover; object-position: 0 33%; opacity: 0.9;"/>
                      <div style="position: absolute; top: 3px; left: 3px; font-size: 14px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-weight: 600;">2</div>
                    </div>
                    <div style="border: 1px dashed #E2E6EA; border-radius: 6px; overflow: hidden; height: 36px; position: relative;">
                      <img src="images/record.png" alt="Prefix part 3" style="width: 100%; height: 100%; object-fit: cover; object-position: 0 66%; opacity: 0.9;"/>
                      <div style="position: absolute; top: 3px; left: 3px; font-size: 14px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-weight: 600;">3</div>
                    </div>
                  </div>
                  <div style="border: 1px solid #E2E6EA; border-radius: 6px; overflow: hidden; height: 128px; position: relative;">
                    <img src="images/record.png" alt="Target chunk" style="width: 100%; height: 100%; object-fit: cover; object-position: bottom;"/>
                    <div style="position: absolute; top: 6px; left: 6px; font-size: 20px; background: var(--berkeley-blue); color: white; border-radius: 50%; width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; font-weight: 600;">4</div>
                  </div>
                  
                  </div>
                  </div>
                </div>

                <div class="fragment" data-fragment-index="7" style="margin-top: 0.5rem; font-size: 30px; color: var(--text-light);">
                  Can mix &amp; match gather configs; e.g., "prefix" tail and "next" head
                </div>
              </div>
          </div>
          
          <aside class="notes">
            Animate: (1) show three cropped slices derived from the same source; (2) overlay chunk labels; (3) reveal gather configs for a target chunk (here, chunk 3) — prefix head, prefix tail, prefix summary (compressed). Conclude with note that you can mix-and-match and also gather next-window context.
          </aside>
        </section>

       
      
        <!-- Rewrite Directives Main Concept -->
        <section data-visibility="hidden">
          <h2>Optimizer</h2>
          
          <ul class="full-width" style="font-size: 34px; line-height: 1.5;">
            <li class="fragment" data-fragment-index="1" style="margin-bottom: 1.5rem;">
              <strong style="color: var(--berkeley-blue);">Naive idea:</strong> Have an LLM just give you a "better" pipeline
              <div style="font-size: 30px; color: var(--text-light); margin-left: 2rem; margin-top: 0.5rem;">
                But it doesn't know how, and the pipeline may not be logically equivalent
              </div>
            </li>
            
            <li class="fragment" data-fragment-index="2" style="margin-bottom: 1.5rem;">
              <strong style="color: var(--berkeley-blue);">Solution:</strong> Rewrite <em>directives</em> — guidelines interpreted by LLMs<br>
              <span style="font-size: 30px; color: var(--text-light); margin-left: 2rem;">based on task and data characteristics</span>
            </li>
            
            <li class="fragment" data-fragment-index="3" style="margin-bottom: 1.5rem;">
              <strong style="color: var(--berkeley-blue);">Evaluation:</strong> No ground-truth, so use LLM-as-Judge<br>
              <span style="font-size: 30px; color: var(--text-light); margin-left: 2rem;">for selecting the best rewrite based on sample outputs</span>
            </li>
            
            <li class="fragment" data-fragment-index="4">
              <strong style="color: var(--berkeley-blue);">Strategy:</strong> Top-down, opportunistically rewrite new<br>
              <span style="font-size: 30px; color: var(--text-light); margin-left: 2rem;">operators if judge thinks they are error-prone</span>
            </li>
          </ul>
        </section>

        <!-- Rewrite Directives Introduction -->
        <section>
          <h2>Rewrite Directives: Our Novel Contribution</h2>
          
          <ul style="font-size: 28px; color: var(--text-dark); margin: 1rem 0; padding-left: 1.5rem;">
            <li style="margin-bottom: 0.8rem; font-size: 28px; color: var(--text-dark);">Templates for LLMs to instantiate</li>
            <li style="margin-bottom: 0.8rem;">
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 28px;"><strong>Example:</strong></div>
                <div style="display: flex; align-items: center; gap: 0.6rem;">
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Document</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Map (extract instances of misconduct)</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Result</div>
                </div>
              </div>
            </li>
            
            <li class="fragment" data-fragment-index="1" style="margin-bottom: 1rem;">
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 28px; color: var(--medalist); font-weight: 600; min-width: 140px;">Chunking:</div>
                <div style="display: flex; align-items: center; gap: 0.6rem;">
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Document</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge new" style="padding: 0.3rem 0.6rem; font-size: 28px;">Split</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Map</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge new" style="padding: 0.3rem 0.6rem; font-size: 28px;">Reduce</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Result</div>
                </div>
              </div>
              <div class="fragment" data-fragment-index="2" style="text-align: center; font-size: 28px; color: var(--text-dark); margin-top: 0.8rem;">
                Choices: chunk size, map prompt, reduce prompt (e.g., "combine extracted misconduct")
              </div>
            </li>
            
            <li class="fragment" data-fragment-index="3" style="margin-bottom: 1rem;">
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 28px; color: var(--medalist); font-weight: 600; min-width: 140px;">Chunking with Gather:</div>
                <div style="display: flex; align-items: center; gap: 0.6rem;">
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Document</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Split</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge new" style="padding: 0.3rem 0.6rem; font-size: 28px;">Gather</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Map</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Reduce</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Result</div>
                </div>
              </div>
              <div class="fragment" data-fragment-index="4" style="text-align: center; font-size: 28px; color: var(--text-dark); margin-top: 0.8rem;">
                Choices: context window, previous chunks?, headers/metadata?
              </div>
            </li>
            
            <li class="fragment" data-fragment-index="5" style="margin-bottom: 1rem;">
              <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 28px; color: var(--medalist); font-weight: 600; min-width: 140px;">Filter Chunks:</div>
                <div style="display: flex; align-items: center; gap: 0.6rem;">
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Document</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Split</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Gather</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge new" style="padding: 0.3rem 0.6rem; font-size: 28px;">Filter</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Map</div>
                  <span style="font-size: 28px; color: var(--text-dark);">→</span>
                  <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Result</div>
                </div>
              </div>
              <div class="fragment" data-fragment-index="6" style="text-align: center; font-size: 28px; color: var(--text-dark); margin-top: 0.8rem;">
                Choices: filter prompt (e.g., "is misconduct present?")
              </div>
            </li>
            
            <li class="fragment" data-fragment-index="7" style="margin-top: 1rem; font-size: 28px; color: var(--berkeley-blue); font-weight: 600;">
              → Infinitely many possible instantiations
            </li>
          </ul>
          
          <aside class="notes">
            Now I am going to explain rewrite directives. Rewrite directives are how we program LLMs to find alternative pipelines to do the task. One way to rewrite a pipeline is to split up the data. Let me give you an example. Say I have a map operation on a long document. I can simply rewrite this map op as, a split -> map -> reduce pipeline; where I split the document into chunks, run the map operation over each chunk, and run a reduce operation to unify the results together. Why do we call this a rewrite directive? Well, an LLM has to instantiate this. An LLM has to write the split logic; e.g., the chunk size or the regex that determines the chunk boundary. The LLM has to adapt the prompt to run at the chunk level. The LLM has to author a reduce operation prompt to unify the results. For example let's say we have a dead simple task like extract all names from a document. We can split into chunks extract names from each chunk, and then have an LLM reduce over the names (hoping it'll dedup and standardize in the process). Now this rewrite might not lead to good accuracy; say, the task is more complex, like extract all instances of misconduct. Here we might see a chunk like "he said ..." and not know who "he" is. So another rewrite directive is split => split -> gather; and in instantiating the rewrite, we have to pick the gather configuration (e.g., how many chunks of the prefix to augment the chunk with). Then imagine the task is actually quite selective in that you do not need most of the document to do the task / there's a lot of irrelevant content. Another rewrite directive you can do is gather -> map => gather -> filter -> map; meaning, throw out chunks that we don't need to do the task for. E.g. police misconduct; say most chunks don't describe misconduct. We can filter for "is misconduct present" and then only do the map "extract and describe the misconduct" on the remaining chunks. OK -- see what I'm saying? There are a bunch of rewrites you can do along the data decomposition axis. Rewrite directives are our formulas that programmatically match to a pipeline and can guide the LLM in writing the custom operators to do the task more accurately. Rewrite directives can have infinitely many instantiations.
          </aside>
        </section>

        <!-- More Rewrite Directives -->
        <section>
          <h2>More Rewrite Directives: Task Decomposition</h2>
          
          <ul style="font-size: 28px; color: var(--text-dark); margin: 1rem 0; padding-left: 1.5rem;">
            <li style="margin-bottom: 1.2rem;">Tasks can be complex beyond just data complexity</li>
            
            <li class="fragment" data-fragment-index="1" style="margin-bottom: 1.2rem;">
              <strong>Example:</strong> 9-10 types of misconduct in California penal code
              <div style="margin-top: 0.4rem; margin-left: 1rem; font-size: 28px; color: var(--text-light);">
                Excessive force, false arrest, evidence tampering, perjury, etc.
              </div>
            </li>
            
            <li class="fragment" data-fragment-index="2" style="margin-bottom: 1.2rem;">
              <div style="font-weight: 600; color: var(--berkeley-blue);">Projection Synthesis:</div>
              
              <!-- First pipeline: Multiple Maps -->
              <div class="fragment" data-fragment-index="3" style="display: flex; align-items: center; gap: 0.6rem; margin-top: 0.5rem; margin-bottom: 0.8rem;">
                <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Document</div>
                <span style="font-size: 28px; color: var(--text-dark);">→</span>
                <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Map: Excessive Force</div>
                <span style="font-size: 28px; color: var(--text-dark);">+</span>
                <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Map: Perjury</div>
                <span style="font-size: 28px; color: var(--text-dark);">+</span>
                <span style="font-size: 28px; color: var(--text-dark);">...</span>
                <span style="font-size: 28px; color: var(--text-dark);">→</span>
                <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Result</div>
              </div>
              
              <!-- Second pipeline: Decomposed Excessive Force -->
              <div class="fragment" data-fragment-index="4" style="display: flex; align-items: center; gap: 0.6rem; margin-top: 0.5rem;">
                <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Document</div>
                <span style="font-size: 28px; color: var(--text-dark);">→</span>
                <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">What weapons?</div>
                <span style="font-size: 28px; color: var(--text-dark);">→</span>
                <div class="op-badge" style="padding: 0.3rem 0.6rem; font-size: 28px;">Excessive use?</div>
                <span style="font-size: 28px; color: var(--text-dark);">→</span>
                <div style="background: white; border: 2px solid var(--text-dark); padding: 0.3rem 0.6rem; border-radius: 6px; font-size: 28px; font-weight: 600;">Result</div>
              </div>
            </li>
            
            <li class="fragment" data-fragment-index="5" style="margin-bottom: 1.2rem;">
              Can synthesize projections before <em>any</em> operation (reduce, filter, join)
            </li>

            
            <li class="fragment" data-fragment-index="6" style="margin-bottom: 1.2rem;">
              <u>Unlike traditional operator fission:</u> requires semantic understanding, open-ended possibilities
            </li>
            
          </ul>
          
          <aside class="notes">
            tasks have multiple dimensions of complexity. data is one dimension of complexity, and in the preivous slide, we saw how we could decompose along the data dimension. we can also decompose along the operation dimension itself. in our example, there are actually 9 types of misconduct in the california penal code detailed. actually 10. 9 types of misconduct in the california penal code detailed. Excessive force (unlawful assault/violence), False arrest/imprisonment (deprivation of liberty without due... ok so reasoning about the presence of all of these different factors in a docmuent is tough. one rewrite is just, have a different map operation for each thing the user requested to extract; e.g., a map operation for excessive use of force, another map .... we call this type of rewrite "projection synthesis" because we are literally synthesizing a porjection. now these projections don't have to take on different independent or isolated aspects of the task. you can also synthesize "sequential" projections to help break a task down into steps. like for use of force. we can rewrite this into two map operations: "what weapons did the officer use, if any" -> "was this an excessive use of the weapon?" and generally you can synthesize projections before any operations, like before reduce or before filter or before join, to do any type of helpful preprocessing for the task. ok so you may be wondering. hmm.this kinda reminds me of operator fission and fusion. what's new here. well the "fission" is not so clean like it is in traditional query plans. it requires some semantic understanding of the task, and really, if you think about it, you can fission into n possible operators, in any open-ended way possible, and it is not clear whether or not the agentic fission is going to give you higher accuracy. no hard coded rules can get you these rewrites. and actually before i talk about fission i'll say; see our paper for many more rewrite directives; i can't cover them all.
          </aside>
        </section>

       

        <!-- Search Algorithm: Top-Down Optimization -->
        <section>
          <h2>Search Algorithm: Top-Down Optimization</h2>
          
          <ul style="font-size: 28px; color: var(--text-dark); margin: 1rem 0; padding-left: 1.5rem;">
            <li style="margin-bottom: 1.2rem;">There are infinitely many rewrites, and rewrites can be composed. How do we find the best pipeline?</li>
            
            <li class="fragment" data-fragment-index="1" style="margin-bottom: 1.2rem;">
              <u>Unlike traditional optimizers:</u> we optimize for <strong style="color: var(--medalist);">accuracy</strong> not cost
            </li>
            
            <li class="fragment" data-fragment-index="2" style="margin-bottom: 1.2rem;">
              <strong style="color: var(--berkeley-blue);">Our 4-step search:</strong>
              <ol style="font-size: 28px; margin-top: 0.5rem; margin-left: 1rem;">
                <li style="margin-bottom: 0.8rem;">
                  <strong>Traverse from beginning to end:</strong> Check if op is accurate as-defined
                </li>
                <li style="margin-bottom: 0.8rem;">
                  <strong>Apply rewrite directives:</strong> If not, generation agent creates plans
                </li>
                <li style="margin-bottom: 0.8rem;">
                  <strong>Recursively optimize:</strong> Optimize new operations immediately (up to depth 3)
                </li>
                <li style="margin-bottom: 0.8rem;">
                  <strong>Select best plan with LLM-as-Judge</strong>
                </li>
              </ol>
            </li>
          </ul>
        </section>

        <!-- Search Algorithm: Agent Architecture -->
        <section data-visibility="hidden">
          <h2>Search Algorithm: Agent Architecture</h2>
          
          <div style="display: flex; gap: 1.5rem; margin-top: 1rem;">
            <!-- Generation Agent -->
            <div class="fragment" data-fragment-index="1" style="flex: 1; background: #f8f9fa; padding: 0.75em 1em; border-radius: 8px; border: 2px solid var(--berkeley-blue);">
              <h3 style="font-size: 32px; color: var(--berkeley-blue); margin: 0 0 0.5rem 0;">Generation Agent</h3>
              <ul style="font-size: 28px; margin: 0; padding-left: 1.2rem; line-height: 1.3;">
                <li style="margin-bottom: 0.5rem;">Synthesizes prompts & schemas for new operations that result from rewrites</li>
                <li>"Physical" params:
                  <ul style="font-size: 28px; margin-top: 0.3rem;">
                    <li>Chunk sizes (15-75%)</li>
                    <li>Batch sizes (20-90%)</li>
                    <li>Blocking rules for resolve and equijoin</li>
                  </ul>
                </li>
              </ul>
            </div>
            
            <!-- Validation Agent -->
            <div class="fragment" data-fragment-index="2" style="flex: 1; background: #f8f9fa; padding: 0.75em 1em; border-radius: 8px; border: 2px solid var(--berkeley-blue);">
              <h3 style="font-size: 32px; color: var(--berkeley-blue); margin: 0 0 0.5rem 0;">Validation Agent</h3>
              <ul style="font-size: 28px; margin: 0; padding-left: 1.2rem; line-height: 1.3;">
                <li style="margin-bottom: 0.5rem;">Creates rubric of criteria<sup style="font-size: 18px; color: var(--founders-rock);">[1]</sup> to evaluate outputs
                  <ul style="font-size: 28px; margin-top: 0.3rem;">
                    <li>Designed around accuracy, precision, recall</li>
                  </ul>
                </li>
                <li>Rates outputs & compares plans</li>
                <!-- <li>Can be different model than generation agent</li> -->
              </ul>
            </div>
          </div>
          
         
          
          <!-- Footnote -->
          <div class="fragment" data-fragment-index="2" style="margin-top: 2rem; padding: 0 3rem;">
            <p style="font-size: 28px; color: var(--text-light); margin: 0;">
              [1] Shankar et al. SPADE: Synthesizing Data Quality Assertions for Large Language Model Pipelines.  <a href="https://www.vldb.org/pvldb/vol17/p4173-shankar.pdf" target="_blank" style="color: var(--founders-rock);">VLDB 2024</a>.
            </p>
          </div>
        </section>

       
        <!-- Evaluation Overview -->
        <section>
          <h2>Evaluation</h2>
          
          <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 1.2rem;">
            <!-- Tasks and Systems in two columns -->
            <div style="display: flex; gap: 2rem;">
              <!-- Left: Tasks -->
              <div class="fragment" data-fragment-index="1" style="flex: 1;">
                <h3 style="font-size: 32px; color: var(--berkeley-blue); margin-bottom: 0.6rem;">5 Complex Tasks</h3>
                <ul style="font-size: 28px; line-height: 1.4; padding-left: 1.5rem; margin: 0;">
                  <li>Legal contracts</li>
                  <li>Game reviews</li>
                  <li>Declassified articles</li>
                  <li>Biomedical articles</li>
                  <li>Police records</li>
                </ul>
              </div>
              
              <!-- Right: Baselines -->
              <div class="fragment" data-fragment-index="2" style="flex: 1;">
                <h3 style="font-size: 32px; color: var(--berkeley-blue); margin-bottom: 0.6rem;">Baselines</h3>
                <ul style="font-size: 28px; line-height: 1.4; padding-left: 1.5rem; margin: 0;">
                  <li>Unoptimized DocETL</li>
                  <li>Other LLM-powered data processing systems</li>
                  <li>Non-LLM baselines</li>
                </ul>
              </div>
            </div>
            
            <!-- Key Results -->
            <div class="fragment" data-fragment-index="3">
              <h3 style="font-size: 32px; color: var(--berkeley-blue); margin-bottom: 0.6rem;">Key Results</h3>
              <div style="display: flex; gap: 1rem;">
                <div style="flex: 1; background: #fff3e0; padding: 1rem; border-radius: 8px; border: 2px solid var(--berkeley-gold);">
                  <p style="font-size: 30px; margin: 0; text-align: center;">
                    <strong style="color: var(--berkeley-blue);">Police Misconduct:</strong><br/>
                    90% improvement in recall
                  </p>
                </div>
                <div style="flex: 1; background: #fff3e0; padding: 1rem; border-radius: 8px; border: 2px solid var(--berkeley-gold);">
                  <p style="font-size: 30px; margin: 0; text-align: center;">
                    <strong style="color: var(--berkeley-blue);">Other Tasks:</strong><br/>
                    21-80% accuracy improvements
                  </p>
                </div>
              </div>
            </div>
            
            <!-- Note -->
            <div class="fragment" data-fragment-index="4">
              <p style="font-size: 26px; color: var(--text-light); font-style: italic; text-align: center; margin: 0;">
                Note: Baselines actively under development. Numbers from Oct/Nov 2024.
              </p>
            </div>
          </div>
        </section>

        <!-- Legal Contract Analysis -->
        <section data-visibility="hidden">
          <h2>Legal Contract Analysis</h2>
          
          <div style="margin-top: 0.5rem;">
            <!-- Top section with Dataset & Task and Baseline Pipeline side by side -->
            <div style="display: flex; gap: 2rem; margin-bottom: 1rem;">
              <!-- Dataset & Task -->
              <div style="flex: 1;">
                <h3 style="font-size: 28px; color: var(--berkeley-blue); margin-bottom: 0.4rem;">Dataset & Task</h3>
                <ul style="font-size: 24px; line-height: 1.3;">
                  <li>CUAD: 50 legal contracts with 41 clause categories</li>
                  <li>Task: Extract text spans</li>
                </ul>
              </div>
              
              <!-- Baseline Pipeline -->
              <div style="flex: 1;">
                <h3 style="font-size: 28px; color: var(--berkeley-blue); margin-bottom: 0.4rem;">Baseline Pipeline</h3>
                <pre style="font-size: 18px; background: #282c34; padding: 0.6rem 0.8rem; border-radius: 6px; color: #abb2bf; line-height: 1.25; overflow-x: auto;">
<span style="color: #e06c75;">- name:</span> <span style="color: #98c379;">extract_clauses</span>
  <span style="color: #e06c75;">type:</span> <span style="color: #61afef;">map</span>
  <span style="color: #e06c75;">prompt:</span> <span style="color: #56b6c2;">|</span>
<span style="color: #98c379;">Extract text spans for the following 41 clause 
types from the legal contract: termination, 
warranties, indemnification, payment terms...</span></pre>
              </div>
            </div>
            
            <!-- Results Table -->
            <div class="fragment" data-fragment-index="2" style="margin-top: -1rem;">
              <h3 style="font-size: 28px; color: var(--berkeley-blue); margin-bottom: 0.2rem;">Results</h3>
              <table style="font-size: 24px; width: 100%; border-collapse: collapse;">
                <thead>
                  <tr style="background: var(--bay-fog);">
                    <th style="padding: 0.4rem; border: 1px solid #ddd;">System</th>
                    <th style="padding: 0.4rem; border: 1px solid #ddd;">Precision</th>
                    <th style="padding: 0.4rem; border: 1px solid #ddd;">Recall</th>
                    <th style="padding: 0.4rem; border: 1px solid #ddd;">F1</th>
                    <th style="padding: 0.4rem; border: 1px solid #ddd;">Runtime (s)</th>
                    <th style="padding: 0.4rem; border: 1px solid #ddd;">Cost ($)</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="background: #e8f5e9; font-weight: 600;">
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">DocETL (Opt.)</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.401</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd; color: var(--success-green);">0.719</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd; color: var(--success-green);">0.477</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">180</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">1.46 (+ 1.58 opt.)</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">DocETL (Unopt.)</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.341</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.430</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.379</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">23</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.08</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">LOTUS</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.402</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.471</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.393</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">28</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.07</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">Palimpzest†</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.059</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.013</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.022</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">84</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">Unknown*</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">Aryn</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.450</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.370</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.352</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">53</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">Unknown*</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">Non-LLM</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.224</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.219</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.190</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">218</td>
                    <td style="padding: 0.3rem; border: 1px solid #ddd;">0.00</td>
                  </tr>
                </tbody>
              </table>
              <p style="font-size: 17px; color: var(--text-light); margin-top: 0.3rem; margin-bottom: 0;">*Costs not reported by the system &nbsp;&nbsp; †Optimizer selected a code-based plan</p>
            </div>
          </div>
        </section>

        <!-- Case Study: Effectiveness of Rewrites -->
        <section data-visibility="hidden">
          <h2>Case Study: Effectiveness of Rewrites</h2>
          
          <div style="display: flex; flex-direction: column; gap: 0.8rem; margin-top: 0.5rem;">
            <!-- Top Row: Case Study and Key Findings side by side -->
            <div style="display: flex; gap: 2rem;">
              <!-- Left: Case Study -->
              <div style="flex: 1;">
                <h3 style="font-size: 28px; color: var(--berkeley-blue); margin: 0 0 0.5rem 0;">30 plans from 3 rewrite types</h3>
                <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.3;">
                  <li style="font-size: 28px;">Projection chaining</li>
                  <li style="font-size: 28px;">Isolated projection</li>
                  <li style="font-size: 28px;">Gleaning</li>
                </ul>
              </div>
              
              <!-- Right: Key Findings -->
              <div class="fragment" data-fragment-index="1" style="flex: 1.2;">
                <h3 style="font-size: 28px; color: var(--berkeley-blue); margin: 0 0 0.5rem 0;">Key Findings</h3>
                <ul style="margin: 0; padding-left: 1.2rem; line-height: 1.3;">
                  <li style="font-size: 28px;">High variance in cost & accuracy</li>
                  <li style="font-size: 28px;">20% had critical errors; half beat baseline</li>
                  <li style="font-size: 28px;">Kendall's τ = 0.642 for judge rankings</li>
                </ul>
                <div style="background: #fff3e0; padding: 0.5rem; border: 2px solid var(--berkeley-gold); border-radius: 6px; margin-top: 0.5rem;">
                  <p style="font-size: 28px; margin: 0; text-align: center;">
                    <strong>→</strong> Need many candidates + selection
                  </p>
                </div>
              </div>
            </div>
            
            <!-- Bottom: Plot -->
            <div style="text-align: center; margin-top: 0.5rem;">
              <img src="images/docetltalk.png" alt="Effectiveness of Rewrites Plot" style="height: 320px; width: auto; max-width: 95%;">
            </div>
          </div>
        </section>

        <!-- Biodex: Biomedical Classification -->
        <section data-visibility="hidden">
          <h2>Biodex: Biomedical Classification</h2>
          
          <div style="margin-top: 0.2rem; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: auto auto; gap: 1rem;">
            <!-- Upper left: Dataset & Task -->
            <div style="grid-column: 1; grid-row: 1;">
              <h3 style="font-size: 28px; color: var(--berkeley-blue); margin-bottom: 0.3rem;">Dataset & Task</h3>
              <ul style="font-size: 28px; line-height: 1.2; margin: 0; padding-left: 1.5rem;">
                <li style="font-size: 28px;">n = 250 biomedical articles of size |d| × m = 24,300 adverse drug reactions</li>
                <li style="font-size: 28px;">Task: Identify which reactions are discussed in each article</li>
                <li style="font-size: 28px;">Metric: Rank-precision@k (RP@k)</li>
              </ul>
            </div>
            
            <!-- Upper right: Pipeline -->
            <div style="grid-column: 2; grid-row: 1;">
              <h3 style="font-size: 28px; color: var(--berkeley-blue); margin-bottom: 0.3rem;">Baseline Pipeline</h3>
              <pre style="font-size: 20px; background: #282c34; padding: 0.5rem 0.8rem; border-radius: 6px; color: #abb2bf; line-height: 1.2; overflow-x: auto;">
<span style="color: #e06c75;">- name:</span> <span style="color: #98c379;">extract_reactions</span>
  <span style="color: #e06c75;">type:</span> <span style="color: #61afef;">equijoin</span>
  <span style="color: #e06c75;">comparison_prompt:</span> <span style="color: #56b6c2;">|</span>
<span style="color: #98c379;">Can the following condition be found in 
the article?</span>
<span style="color: #e06c75;">- name:</span> <span style="color: #98c379;">rank_results</span>
  <span style="color: #e06c75;">type:</span> <span style="color: #61afef;">map</span>
  <span style="color: #7f848e;"># Rank identified labels per article</span></pre>
              <p style="font-size: 22px; color: var(--text-light); margin-top: 0.3rem; margin-bottom: 0;">Optimizer wrote blocking rules requiring keyword match</p>
            </div>
            
            <!-- Lower left: Results Table (narrower) -->
            <div class="fragment" data-fragment-index="2" style="grid-column: 1; grid-row: 2; align-self: start; margin-top: -4rem;">
              <h3 style="font-size: 28px; color: var(--berkeley-blue); margin-bottom: 0.3rem;">Results</h3>
              <table style="font-size: 26px; width: auto; border-collapse: collapse;">
                <thead>
                  <tr style="background: var(--bay-fog);">
                    <th style="padding: 0.3rem 0.6rem; border: 1px solid #ddd; text-align: left; font-size: 26px;">System</th>
                    <th style="padding: 0.3rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">RP@5</th>
                    <th style="padding: 0.3rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">RP@25</th>
                  </tr>
                </thead>
                <tbody>
                  <tr style="background: #e8f5e9;">
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">DocETL Join + Map</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">0.281</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; color: var(--success-green); font-size: 26px;">0.371</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">Project-Sim-Filter + Map‡</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">0.289</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">—</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">Map-Search-Filter†</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">0.213</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">0.206</td>
                  </tr>
                  <tr>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">Keyword match</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">0.106</td>
                    <td style="padding: 0.25rem 0.6rem; border: 1px solid #ddd; font-size: 26px;">0.262</td>
                  </tr>
                </tbody>
              </table>
              <p style="font-size: 20px; color: var(--text-light); margin-top: 0.2rem;">†Replicated from LOTUS pre-print &nbsp; ‡Reported from LOTUS paper</p>
            </div>

            <!-- Lower right: Key Insight -->
            <div class="fragment" data-fragment-index="3" style="grid-column: 2; grid-row: 2; align-self: start;">
              <div style="background: #fff3e0; padding: 0.8rem; border: 2px solid var(--berkeley-gold); border-radius: 8px;">
                <h4 style="font-size: 26px; color: var(--berkeley-blue); margin: 0 0 0.4rem 0;">Maybe the best pipeline is actually a logical rewrite?</h4>
                <p style="font-size: 26px; margin: 0 0 0.4rem 0;">
                  Expressing as <strong>Map</strong> instead of Join:
                </p>
                <ul style="font-size: 26px; margin: 0; padding-left: 1.5rem; line-height: 1.3;">
                  <li style="font-size: 26px;">RP@5=0.260 with gpt-4o-mini; <strong>RP@5=0.390</strong> with gpt-5</li>
                  <li style="font-size: 26px;"><strong>Cost/doc:</strong> O(|d| + m) instead of O(|d| × m)</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        
        <!-- Connecting to Traditional RDBMS -->
        <section>
          <h2>Revisiting Traditional Database Paradigms</h2>
          
          <ul class="fragment" data-fragment-index="0" style="margin: 1rem 0; padding-left: 1.5rem; text-align: left;">
            <li style="font-size: 28px; text-align: left;">Unstructured data + LLMs introduce fuzziness and creativity</li>
          </ul>
          
          <div style="display: flex; flex-direction: column; gap: 1rem; margin-top: 0.3rem;">
            <!-- Operators -->
            <div class="fragment" data-fragment-index="1">
              <h3 style="font-size: 30px; color: var(--berkeley-blue); margin-bottom: 0.3rem;">Operators</h3>
              <div style="display: flex; gap: 1rem;">
                <div style="flex: 1; background: #f8f9fa; padding: 0.6rem; border-radius: 6px; border: 2px solid #e0e0e0;">
                  <p style="font-size: 26px; margin: 0;"><strong>Traditional:</strong> Deterministic, clean logical vs physical separation</p>
                </div>
                <div style="flex: 1; background: #fff3e0; padding: 0.6rem; border-radius: 6px; border: 2px solid var(--berkeley-gold);">
                  <p style="font-size: 26px; margin: 0;"><strong>DocETL:</strong> Fuzzy semantics for unstructured data; LLMs write new algorithms on-the-fly</p>
                </div>
              </div>
            </div>

            <!-- Rewriting -->
            <div class="fragment" data-fragment-index="2">
              <h3 style="font-size: 30px; color: var(--berkeley-blue); margin-bottom: 0.3rem;">Rewrite Rules</h3>
              <div style="display: flex; gap: 1rem;">
                <div style="flex: 1; background: #f8f9fa; padding: 0.6rem; border-radius: 6px; border: 2px solid #e0e0e0;">
                  <p style="font-size: 26px; margin: 0;"><strong>Traditional:</strong> Guaranteed identical output, finite set of rewrites</p>
                </div>
                <div style="flex: 1; background: #fff3e0; padding: 0.6rem; border-radius: 6px; border: 2px solid var(--berkeley-gold);">
                  <p style="font-size: 26px; margin: 0;"><strong>DocETL:</strong> Open-ended, semantic rewrites; rewrites yield different accuracies</p>
                </div>
              </div>
            </div>

            <!-- Optimization -->
            <div class="fragment" data-fragment-index="3">
              <h3 style="font-size: 30px; color: var(--berkeley-blue); margin-bottom: 0.3rem;">Optimization</h3>
              <div style="display: flex; gap: 1rem;">
                <div style="flex: 1; background: #f8f9fa; padding: 0.6rem; border-radius: 6px; border: 2px solid #e0e0e0;">
                  <p style="font-size: 26px; margin: 0;"><strong>Traditional:</strong> Cost models, dynamic programming (Selinger, Cascades)</p>
                </div>
                <div style="flex: 1; background: #fff3e0; padding: 0.6rem; border-radius: 6px; border: 2px solid var(--berkeley-gold);">
                  <p style="font-size: 26px; margin: 0;"><strong>DocETL:</strong> Accuracy is empirical; operator quality is interdependent</p>
                </div>
              </div>
            </div>

          </div>
          
          <!-- Key Insight -->
          <ul class="fragment" data-fragment-index="4" style="margin: 1.5rem 0; padding-left: 1.5rem; text-align: left;">
            <li style="font-size: 28px; text-align: left;">Query optimizer must reason about inaccuracy, operator interdependence, and new algorithms authored on-the-fly</li>
          </ul>
        </section>

        <!-- Promise of Agentic Query Rewrites -->
        <section data-visibility="hidden">
          <h2>The Promise of Agentic Query Rewrites</h2>
          
          <div style="margin-top: 0.5rem;">
            <!-- Vision -->
            <div class="fragment" data-fragment-index="1" style="background: #fff3e0; padding: 0.6rem; border: 2px solid var(--berkeley-gold); border-radius: 8px; margin-bottom: 2rem;">
              <p style="font-size: 30px; margin: 0; text-align: center;">
                <strong>Vision:</strong> Agents that automatically discover optimal query rewrites<br/>
                <span style="font-size: 28px; color: var(--text-light);">Early-stage work with lots of potential!</span>
              </p>
            </div>

            <!-- Two Column Layout -->
            <div style="display: flex; gap: 3rem;">
              <!-- Left Column: Directions to Explore -->
              <div style="flex: 1;" class="fragment" data-fragment-index="2">
                <h3 style="font-size: 32px; color: var(--berkeley-blue); margin-bottom: 1rem;">Directions to Explore</h3>
                <ul style="margin: 0; padding-left: 1.5rem;">
                  <li style="font-size: 28px; margin-bottom: 0.5rem;">Optimize for cost and accuracy, not just accuracy</li>
                  <li style="font-size: 28px; margin-bottom: 0.5rem;">More efficient search algorithms</li>
                  <li style="font-size: 28px; margin-bottom: 0.5rem;">Predict cost/accuracy without running samples</li>
                  <li style="font-size: 28px;">Expand set of rewrite directives</li>
                </ul>
              </div>

              <!-- Right Column: Application to SQL -->
              <div style="flex: 1;" class="fragment" data-fragment-index="3">
                <h3 style="font-size: 32px; color: var(--berkeley-blue); margin-bottom: 1rem;">Application to SQL Optimization</h3>
                <p style="font-size: 28px; margin: 0 0 1rem 0;">
                  LLM agents could explore logical rewrites <strong>before</strong> traditional optimizers:
                </p>
                <ul style="margin: 0; padding-left: 1.5rem;">
                  <li style="font-size: 28px; margin-bottom: 0.5rem;">Automatically write UDFs as rewrite directives</li>
                  <li style="font-size: 28px; margin-bottom: 0.5rem;">Rewrite correlated subqueries</li>
                  <li style="font-size: 28px;">Feed enhanced logical plans to Cascades-style optimizers</li>
                </ul>
              </div>
            </div>
          </div>
        </section>

        <!-- Grand Concluding Slide -->
        <section>
          <h1 style="font-size: 56px; margin-bottom: 1rem;">Thank You! Questions?</h1>
          
          <!-- Key Takeaways -->
          <div style="background: #fff3e0; padding: 0.8rem 1.2rem; border: 2px solid var(--berkeley-gold); border-radius: 8px; margin-bottom: 1.5rem;">
            <ul style=" margin: 0; padding-left: 1.2rem; line-height: 1.3; list-style: none;">
              <li style="margin-bottom: 0.3rem; font-size: 30px;"><strong>→</strong> DocETL is a system for LLM-powered data processing</li>
              <li style="font-size: 30px;"><strong>→</strong> Our optimizer leverages <strong>agents</strong> to instantiate <strong>novel rewrite directives</strong></li>
            </ul>
          </div>
          
          <!-- Three Column Layout -->
          <div style="display: flex; align-items: flex-start; justify-content: center; gap: 3rem;">
            <!-- Contact Column -->
            <div style="flex: 1; display: flex; align-items: flex-start; justify-content: center; padding-top: 2.5rem;">
              <div style="background: white; padding: 2rem 1.5rem; border: 2px solid var(--berkeley-blue); border-radius: 10px; text-align: center;">
                <p style="font-size: 28px; margin: 0 0 1.5rem 0; font-weight: bold; color: var(--berkeley-blue);">
                  Shreya Shankar
                </p>
                <p style="font-size: 28px; margin: 0 0 2rem 0;">
                  🌐 <a href="https://sh-reya.com" style="color: var(--berkeley-blue); text-decoration: underline;">sh-reya.com</a>
                </p>
                <div style="background: var(--berkeley-gold); padding: 1rem; border-radius: 6px;">
                  <p style="font-size: 28px; margin: 0 0 0.5rem 0; color: var(--berkeley-blue); font-weight: bold;">
                    On the job market!
                  </p>
                  <p style="font-size: 24px; margin: 0; color: var(--berkeley-blue);">
                    Seeking tenure-track<br/>faculty positions
                  </p>
                </div>
              </div>
            </div>
            
            <!-- DocETL Column -->
            <div style="flex: 1; text-align: center;">
              <img src="images/docetl-code.png" alt="DocETL QR Code" style="width: 220px; height: 220px;" />
              <p style="font-size: 28px; margin: 0.5rem 0; font-weight: bold; color: var(--berkeley-blue);">
                DocETL (VLDB 2025)
              </p>
              <p style="font-size: 24px; margin: 0;">
                <a href="https://docetl.org" target="_blank" rel="noopener" style="color: var(--berkeley-blue);">docetl.org</a> • 
                <a href="https://github.com/ucbepic/docetl" target="_blank" rel="noopener" style="color: var(--berkeley-blue);">github.com/ucbepic/docetl</a>
              </p>
            </div>
            
            <!-- DocWrangler Column -->
            <div style="flex: 1; text-align: center;">
              <img src="images/docwrangler-code.png" alt="DocWrangler QR Code" style="width: 220px; height: 220px;" />
              <p style="font-size: 28px; margin: 0.5rem 0; font-weight: bold; color: var(--berkeley-blue);">
                DocWrangler (UIST 2025)
              </p>
              <p style="font-size: 28px; margin: 0; color: var(--text-light);">
                Pipeline/task discovery
              </p>
            </div>
          </div>
        </section>
      </div>
      
    </div>

    <!-- Reveal.js scripts -->
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5/dist/reveal.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5/plugin/markdown/markdown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5/plugin/notes/notes.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/reveal.js@5/plugin/highlight/highlight.js"></script>
    <script>
      Reveal.initialize({
        hash: true,
        slideNumber: 'c',
        // Available transitions: 'none', 'fade', 'slide', 'convex', 'concave', 'zoom'
        transition: 'fade',
        width: 1280,  // PowerPoint 16:9 width
        height: 720,  // PowerPoint 16:9 height
        margin: 0.02, // Smaller margin for more content space
        minScale: 0.2,
        maxScale: 2.0,
        center: true,
        plugins: [ RevealMarkdown, RevealNotes, RevealHighlight ]
      });

      // No custom animation on the police misconduct slide
    </script>
  </body>
  </html>
